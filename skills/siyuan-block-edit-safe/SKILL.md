---
name: siyuan-block-edit-safe
description: 思源块级安全编辑技能：先确认 BlockID 和范围，优先最小改动，写后回读校验，并提供可执行回滚方案。
---

# SiYuan 块级安全编辑

## 适用场景
- 用户要求修改现有笔记块、插入块、批量调整文本。

## 执行规则
- 修改前先确认 BlockID、文档范围、操作类型（update/insert）。
- 优先块级精确更新，不做整文覆盖。
- 批量改动时分批执行，每批后立即回读，避免一次性放大风险。
- 关键字段（ID、路径、URL）保持原样，不擅自重写格式。
- 编辑说明必须写“改了什么、为什么改、如何验证”。

## 校验规则
- 每次写入后回读目标块，检查内容是否和预期一致。
- 若有格式化副作用（被规范化、丢字段），立即记录并切换备选写法。

## 回滚规则
- 写入前备份原块内容。
- 失败时使用备份执行一次回滚更新，并回读确认恢复成功。

## 输出格式
- 变更清单（块 ID + 操作）
- 最小回归验证
- 可执行验证结果（通过/失败 + 关键输出）

